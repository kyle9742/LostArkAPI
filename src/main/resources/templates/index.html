<!doctype html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/basic.html}">
<head>
    <title>LostArkAPI - Main</title>
</head>

<div layout:fragment="content">
    <div class="container my-5">
        <div class="notices d-flex flex-wrap my-5">

        </div>
        <div class="events d-flex justify-content-evenly flex-wrap my-5">

        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script th:src="@{/js/Notices.js}"></script>
    <script th:src="@{/js/Events.js}"></script>
</div>

<script layout:fragment="script" th:inline="javascript">
    const noticesDiv = document.querySelector('.notices')
    const eventsDiv = document.querySelector('.events');

    function printNotices() {

        let str = '';

        getNotices().then(data => {
            str += `<ul class="list-group w-100">`;
            str += `<li class="list-group-item list-group-item-secondary">
                        <h4>로스트아크 공지사항</h4>
                    </li>`
            console.log(data)
            for(let i = 0 ; i < 10 ; i++) {
                str += `<li class="list-group-item list-group-item-action bg-dark">
                            <span class="badge text-bg-secondary mx-3">${data[i].Type}</span><a href="${data[i].Link}" class="link-offset-2 link-underline link-underline-opacity-0 text-light">${data[i].Title}</a>
                        </li>`
            }
            str += `</ul>`;
            noticesDiv.innerHTML = str;
        }).catch(e => {
            console.log(e)
        });
    }

    function printEvents() {

        let str = '';

        getEvents().then(data => {

            for (const item of data) {

                str += `
                            <div class="card bg-dark text-light">
                                <a href="${item.Link}"><img src="${item.Thumbnail}" class="card-img-top" alt="eventImage"></a>
                                <div class="card-body">
                                    <h5 class="card-title">${item.Title}</h5>
                                    <p class="card-text">시작날짜 : ${`${item.StartDate}`.substring(0, 10)}</p>
                                    <p class="card-text">종료날짜 : ${`${item.EndDate}`.substring(0, 10)}</p>
                                </div>
                            </div>
                        `
            }
            eventsDiv.innerHTML = str;

        }).catch(e => {
            console.log(e)
        });

    }

    printEvents();
    printNotices();

</script>

</html>